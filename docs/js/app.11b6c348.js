(function(t){function e(e){for(var i,r,o=e[0],c=e[1],u=e[2],p=0,h=[];p<o.length;p++)r=o[p],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(h.length)h.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},s={app:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/test-ctrl-hack/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0b32":function(t,e,n){"use strict";n("2d43")},"2d43":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);var i=n("2b0e"),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Main")],1)},a=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-form"},[e("div",{staticClass:"main-form__row"},[e("div",{staticClass:"main-form__col-3"},[e("input",{attrs:{type:"number",placeholder:"Цена",id:"price"},domProps:{value:t.displayPrice},on:{input:function(e){return t.setValue("price",e)}}}),e("label",{staticClass:"text-center",attrs:{for:"price"}},[t._v(t._s(t.displayPrice))])]),e("div",{staticClass:"main-form__col-3"},[e("input",{attrs:{type:"text",placeholder:"Количество",id:"qty"},domProps:{value:t.displayQty},on:{input:function(e){return t.setValue("qty",e)}}}),e("label",{staticClass:"text-center",attrs:{for:"price"}},[t._v(t._s(t.displayQty))])]),e("div",{staticClass:"main-form__col-3"},[e("input",{attrs:{type:"text",id:"amount",placeholder:"Сумма"},domProps:{value:t.displayAmount},on:{input:function(e){return t.setValue("amount",e)}}}),e("label",{staticClass:"text-center",attrs:{for:"price"}},[t._v(t._s(t.displayAmount))])]),e("div",{staticClass:"main-form__col-3"},[e("button",{attrs:{disabled:!t.enableSend},on:{click:t.handleSend}},[t._v("Отправить")]),e("span",{staticClass:"main-form__info"},[t._v(t._s(t.info))])])]),e("div",{staticClass:"main-form__logs"},[e("textarea",{staticClass:"main-form__textarea",attrs:{name:"logs",id:"logs"},domProps:{value:t.logs}})])])},o=[],c=(n("33d1"),n("ea98"),n("14d9"),n("d9e2"),function(t,e=300){let n=null;return function(...i){null!==n&&clearTimeout(n);const s=this;n=setTimeout(()=>{n=null,t.apply(s,i)},e)}});const u="test-ctrl-hack-";function l(){const t=parseInt(localStorage.getItem(u+"nonce")||1);return localStorage.setItem(u+"nonce",t+1),t}function p(){return localStorage.getItem(u+"info")||""}function h({nonce:t,qty:e,price:n,amount:i}){localStorage.setItem(u+"info",JSON.stringify({nonce:t,qty:e,price:n,amount:i}))}const d=1e3;async function f(t){try{if(await new Promise(t=>setTimeout(t,d)),t.qty%2!==0)throw new Error("Ошибка сохранения данных");return h(t),{success:!0}}catch(e){return console.error(e.message),{success:!1}}}var m={name:"Main",data(){return{qty:0,price:0,amount:0,info:p(),logs:"",queue:[],lockWatch:!1}},watch:{qty(){this.lockWatch||(this.addLog("Измение значения поля ввода количества. Новое значение: "+(this.displayQty||"отсутствует")),this.calculate("qty"))},price(){this.lockWatch||(this.addLog("Измение значения поля ввода цены. Новое значение: "+(this.displayPrice||"отсутсвует")),this.calculate("price"))},amount(){this.lockWatch||(this.addLog("Измение значения поля ввода суммы. Новое значение: "+(this.displayAmount||"отсутствует")),this.calculate("amount"))}},computed:{displayQty(){return this.qty?this.qty.toFixed(0):""},displayPrice(){return this.price?this.price.toFixed(2):""},displayAmount(){return this.amount?this.amount.toFixed(2):""},enableSend(){return!!this.amount&&!!this.qty&&!!this.price}},methods:{setValue:c((function(t,e){this[t]="qty"===t?parseInt(e.target.value):parseFloat(e.target.value)}),300),calculate(t){this.queue.at(-1)!==t&&this.queue.push(t),this.queue.length<2||(this.queue.length>2&&this.queue.shift(),this.lockWatch=!0,this.queue.includes("qty")||this.calcQty(),this.queue.includes("amount")||this.calcAmount(),this.queue.includes("price")||this.calcPrice(),this.$nextTick(()=>{this.lockWatch=!1}))},calcPrice(){this.price=this.amount/this.qty},calcAmount(){this.amount=this.qty*this.price},calcQty(){this.qty=this.amount/this.price},async handleSend(){const t={nonce:l(),qty:this.qty,price:this.price,amount:this.amount};this.addLog(`Попытка отправить данные: ${JSON.stringify(t)} на бекенд. Текущие данные ${this.info||"отсутствуют"}`);try{const e=await f(t);if(!e.success)throw new Error(`Ошибка при попытке отправки данных. Ответ сервера ${JSON.stringify(e)}. Текущие данные ${this.info||"отсутсвуют"}`);this.info=p(),this.addLog(`Успешная попытка отправки данных. Ответ сервера ${JSON.stringify(e)}. Текущие данные ${this.info||"отсутсвуют"}`)}catch(e){this.addLog(e.message)}},addLog(t){this.logs=Date()+": "+t+"\n"+this.logs}}},y=m,g=(n("9a89"),n("2877")),v=Object(g["a"])(y,r,o,!1,null,null,null),_=v.exports,b={name:"App",components:{Main:_}},q=b,w=(n("0b32"),Object(g["a"])(q,s,a,!1,null,null,null)),x=w.exports;i["a"].config.productionTip=!1,new i["a"]({render:t=>t(x)}).$mount("#app")},"9a89":function(t,e,n){"use strict";n("cc4d")},cc4d:function(t,e,n){}});
//# sourceMappingURL=app.11b6c348.js.map